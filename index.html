<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„ÙØ­Øµ</title>

<style>
body{
  font-family: system-ui;
  background:#0f172a;
  color:white;
  text-align:center;
  padding:30px;
}

input,button,select{
  padding:12px;
  margin:6px;
  font-size:16px;
  border-radius:10px;
  border:none;
}

button{
  cursor:pointer;
  background:#22c55e;
  color:white;
}

#testsList{
  width:300px;
  margin:auto;
}

.testItem{
  background:#1e293b;
  padding:10px;
  margin:6px;
  border-radius:10px;
  display:flex;
  justify-content:space-between;
  cursor:grab;
}

.dragging{
  opacity:.5;
}

/* ğŸ¬ Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ */
.modal{
  position:fixed;
  inset:0;
  display:none;
  justify-content:center;
  align-items:center;
  backdrop-filter:blur(10px);
  background:rgba(0,0,0,.6);
  animation:fadeIn .4s;
}

.modalCard{
  background:#020617;
  padding:25px;
  border-radius:20px;
  width:320px;
  box-shadow:0 0 40px #22c55e;
  transform:scale(.7);
  opacity:0;
  animation:zoomIn .4s forwards;
}

@keyframes zoomIn{
  to{transform:scale(1);opacity:1;}
}
@keyframes fadeIn{
  from{opacity:0}
  to{opacity:1}
}
</style>
</head>

<body>

<h2>Ù†Ø¸Ø§Ù… Ø§Ù„ÙØ­Øµ</h2>

<input id="name" placeholder="Ø§Ù„Ø§Ø³Ù…"><br>
<input id="nid" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ"><br>

<button id="insuranceBtn">ØªØ£Ù…ÙŠÙ† ØµØ­ÙŠ</button>
<button onclick="copyMsg()">Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø©</button>

<h3>Ø§Ù„ÙØ­ÙˆØµØ§Øª</h3>
<div id="testsList"></div>

<!-- ğŸ¬ Ù…ÙˆØ¯Ø§Ù„ Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ -->
<div id="modal" class="modal">
  <div class="modalCard">
    <h3>Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØµØ­ÙŠ</h3>

    <select id="insSel">
      <option value="none">Ù„Ø§ ÙŠÙˆØ¬Ø¯</option>
      <option value="ÙØ¶ÙŠ">ÙØ¶ÙŠ</option>
      <option value="Ø°Ù‡Ø¨ÙŠ">Ø°Ù‡Ø¨ÙŠ</option>
      <option value="Ø¨Ù„Ø§ØªÙŠÙ†ÙŠ">Ø¨Ù„Ø§ØªÙŠÙ†ÙŠ</option>
      <option value="auto">ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</option>
    </select>

    <br><br>
    <button onclick="saveIns()">Ø­ÙØ¸</button>
  </div>
</div>

<script>
const $=id=>document.getElementById(id);

const TESTS=[
"Ø¶ØºØ· Ø§Ù„Ø¯Ù…",
"Ø§Ù„Ù†Ø¸Ø±",
"Ø§Ù„Ø³Ù…Ø¹",
"Ø§Ù„Ø³ÙƒØ±",
"Ø§Ù„Ù„ÙŠØ§Ù‚Ø©"
];

let state={
 name:"",
 nid:"",
 insurance:"none",
 tests:[0,0,0,0,0]
};

/* Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ­ÙˆØµØ§Øª */
const list=$("testsList");
function render(){
 list.innerHTML="";
 TESTS.forEach((t,i)=>{
  const d=document.createElement("div");
  d.className="testItem";
  d.draggable=true;
  d.innerHTML=`${t}<input type=number min=0 max=100 value=${state.tests[i]||0}>`;

  d.ondragstart=()=>d.classList.add("dragging");
  d.ondragend=()=>d.classList.remove("dragging");

  d.querySelector("input").oninput=e=>{
    state.tests[i]=+e.target.value;
  };

  list.appendChild(d);
 });
}
render();

/* Ø§Ù„Ø³Ø­Ø¨ */
list.ondragover=e=>{
 e.preventDefault();
 const drag=document.querySelector(".dragging");
 const after=[...list.children]
  .find(el=>e.clientY<=el.offsetTop+el.offsetHeight/2);
 if(after) list.insertBefore(drag,after);
 else list.appendChild(drag);
};

/* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
$("insuranceBtn").onclick=()=>{
 $("modal").style.display="flex";
};

function saveIns(){
 state.insurance=$("insSel").value;
 $("modal").style.display="none";
}

/* ğŸ¯ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ */
function autoInsurance(){
 const avg=state.tests.reduce((a,b)=>a+b,0)/state.tests.length;

 if(avg>=85) return "Ø¨Ù„Ø§ØªÙŠÙ†ÙŠ";
 if(avg>=60) return "Ø°Ù‡Ø¨ÙŠ";
 if(avg>=30) return "ÙØ¶ÙŠ";
 return "Ù„Ø§ ÙŠÙˆØ¬Ø¯";
}

/* Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø© */
function copyMsg(){
 state.name=$("name").value;
 state.nid=$("nid").value;

 let ins=state.insurance;

 if(ins==="auto") ins=autoInsurance();
 if(ins==="none") ins="";

 let msg=
"```\n"+
"Ø§Ù„Ø§Ø³Ù… : "+state.name+"\n"+
"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ : "+state.nid+"\n"+
"Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ÙØ­Øµ Ù„ÙŠØ§Ù‚Ù‡\n";

 if(ins) msg+="Ù†ÙˆØ¹ Ø§Ù„ØªØ£Ù…ÙŠÙ† : "+ins+"\n";

 msg+="```";

 navigator.clipboard.writeText(msg);
 alert("ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…");
}

/* ğŸš€ Ø¨Ø§ØªØ´ Ù†ÙˆØª Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© */
if(!localStorage.patch){
 setTimeout(()=>{
  alert(
`ğŸš€ PATCH NOTES

âœ¨ Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØµØ­ÙŠ
âœ¨ Ù†Ø¸Ø§Ù… Ø¯Ø±Ø¬Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠ
âœ¨ Ø³Ø­Ø¨ Ø§Ù„ÙØ­ÙˆØµØ§Øª
âœ¨ Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ

ğŸ”¥ ØªØ¬Ø±Ø¨Ø© Ø®ÙˆØ±Ø§ÙÙŠØ©`
  );
  localStorage.patch=1;
 },700);
}
</script>

</body>
</html>
